# 🚀 MetaPlaza 개발 환경 설정 가이드

## 서버 구동 방법

### 1️⃣ 프론트엔드 서버 실행
```bash
# 프로젝트 루트 디렉토리에서
npm start
```
- 실행 후 브라우저에서 `http://localhost:3000` 자동 오픈
- React 개발 서버가 3000번 포트에서 실행됩니다

### 2️⃣ 백엔드 서버 실행

#### 방법 1: IntelliJ IDEA에서 실행 (권장)
1. **Gradle 프로젝트 열기**
   - IntelliJ에서 `File` → `Open`
   - `backend/build.gradle` 파일 선택
   - "Open as Project" 클릭

2. **Gradle Sync 대기**
   - IntelliJ가 자동으로 의존성 다운로드 & 빌드 시작
   - 우측 하단 또는 "Gradle" 탭에서 진행 상황 확인
   - 완료될 때까지 대기 (처음엔 수 분 소요 가능)

3. **애플리케이션 실행**
   - `src/main/java/com/community/CommunityApplication.java` 파일 열기
   - 파일 우클릭 → `Run 'CommunityApplication'`
   - 또는 `main` 메서드 옆 초록색 ▶️ 버튼 클릭

#### 방법 2: 터미널에서 실행
```bash
# backend 디렉토리로 이동
cd backend

# Gradle로 Spring Boot 실행
./gradlew bootRun

# 수동 빌드가 필요한 경우
./gradlew clean build
```

#### 실행 확인
- Spring Boot 서버가 8080번 포트에서 실행됩니다
- API 엔드포인트: `http://localhost:8080`
- 콘솔에 "Started CommunityApplication" 메시지 확인

---

## 📋 구현된 기능 확인하기

### 1. 로그인/회원가입
1. 프론트엔드 실행 후 첫 화면에서 "Click to Start" 클릭
2. **회원가입**:
   - 닉네임, 이메일, 비밀번호 입력
   - 회원가입 완료 메시지 확인
   - 초기 화면으로 돌아감 (자동 로그인 없음)
3. **로그인**:
   - 이메일, 비밀번호 입력
   - 로그인 성공 시 3D 환경 진입

### 2. 캐릭터 이동
- **이동**: `W` `A` `S` `D` 또는 방향키
- **달리기**: `Shift` + 이동키
- **카메라 위치 로그**: `C` 키 (개발자 콘솔 확인)

### 3. 게시판 (로그인 후 사용 가능)
1. 우측 상단 **게시판 아이콘 (📋)** 클릭
2. **사이드바**:
   - 게시판 / 공지사항 전환
   - 햄버거 메뉴로 사이드바 숨김/표시
3. **글쓰기**:
   - 게시판 목록에서 "글쓰기" 버튼
   - 제목, 내용, 이미지 URL(선택) 입력
   - 작성 완료 클릭
4. **게시글 보기**:
   - 게시글 클릭 → 상세 페이지
   - 추천/비추천 버튼
   - 댓글 작성 (프론트엔드만 구현, 백엔드 연동 필요)

### 4. ESC 메뉴
- **ESC 키** 누르기 → 메뉴 모달 표시
- **계속하기**: 게임 복귀
- **설정**: 준비 중
- **로그아웃**: 로그아웃 후 초기 화면

### 5. 맵 전환
- 우측 상단 **"Open Map"** 버튼 → Mapbox 3D 지도 표시
- 좌측 상단 **"Back"** 버튼 → 기본 3D 환경 복귀

---

## 🎮 모달 사용 시 주의사항

**모달이 열려있을 때 캐릭터 이동이 자동으로 비활성화됩니다:**
- 게시판 모달
- ESC 메뉴 모달
- 로그인/회원가입 모달

모달을 닫으면 이동 기능이 다시 활성화됩니다.

---

## 🗄️ 데이터베이스 (Supabase)

### 연결 정보
- **데이터베이스**: PostgreSQL (Supabase)
- **설정 파일**: `backend/src/main/resources/application.yml`
- **현재 플랜**: Free (무료)

### 주요 테이블
- `auth.users` - 사용자 계정 (Supabase Auth)
- `public.profiles` - 사용자 프로필
- `public.boards` - 게시판
- `public.posts` - 게시글
- `public.comments` - 댓글

### 현재 데이터 현황
- **사용자**: 8명 등록
- **게시판**: 1개 (자유게시판)
- **게시글**: 0개

---

## 🛠️ 개발 환경

### 프론트엔드
- **프레임워크**: React 19.1.1
- **3D 엔진**: Three.js 0.179.1
  - React Three Fiber 9.3.0
  - React Three Drei 10.7.4
  - React Three Rapier 2.2.0 (물리 엔진)
- **HTTP 클라이언트**: Axios
- **아이콘**: React Icons

### 백엔드
- **프레임워크**: Spring Boot 3.2.0
- **언어**: Java 21
- **빌드 도구**: Gradle
- **데이터베이스**: PostgreSQL (Supabase)
- **인증**: JWT (JSON Web Token)
- **주요 라이브러리**:
  - Spring Data JPA
  - Spring Security
  - Lombok

---

## 📁 프로젝트 구조

```
3DCommunity/
├── src/                          # 프론트엔드 소스
│   ├── components/              # React 컴포넌트
│   │   ├── AuthModal.js        # 로그인/회원가입
│   │   ├── BoardModal.js       # 게시판 메인
│   │   ├── BoardList.js        # 게시글 목록
│   │   ├── BoardDetail.js      # 게시글 상세
│   │   ├── PostForm.js         # 글쓰기 폼
│   │   ├── MenuModal.js        # ESC 메뉴
│   │   ├── LandingPage.js      # 초기 화면
│   │   └── Mapbox3D.js         # 지도 컴포넌트
│   ├── services/                # API 서비스
│   │   ├── authService.js      # 인증 API
│   │   └── boardService.js     # 게시판 API
│   ├── App.js                   # 메인 앱 (3D 씬)
│   └── useKeyboardControls.js   # 키보드 입력 훅
├── backend/                     # 백엔드 소스
│   └── src/main/java/com/community/
│       ├── controller/          # REST API 컨트롤러
│       ├── service/             # 비즈니스 로직
│       ├── repository/          # JPA 레포지토리
│       ├── model/               # 엔티티 (User, Board, Post 등)
│       ├── dto/                 # 데이터 전송 객체
│       └── security/            # JWT 인증/보안
├── public/resources/            # 3D 모델 & 사운드
│   ├── Ultimate Animated Character Pack/
│   ├── GameView/PublicSquare.glb
│   └── Sounds/
└── README.md                    # 프로젝트 개요 (한글)
```

---

## 🔑 환경 변수 설정

### 프론트엔드 (.env)
```env
REACT_APP_API_URL=http://localhost:8080
REACT_APP_MAPBOX_TOKEN=your_mapbox_token_here
```

### 백엔드 (application.yml)
이미 설정되어 있음:
- Supabase PostgreSQL 연결
- JWT Secret Key
- CORS 설정

---

## 🐛 문제 해결

### 프론트엔드가 실행되지 않을 때
```bash
# node_modules 재설치
rm -rf node_modules package-lock.json
npm install --legacy-peer-deps
npm start
```

### 백엔드 연결 오류
1. Spring Boot 서버가 실행 중인지 확인 (`localhost:8080`)
2. Supabase 데이터베이스 연결 확인
3. `application.yml`의 DB 비밀번호 확인

### 게시판에 데이터가 안 보일 때
- 현재 게시글이 0개입니다
- 로그인 후 직접 글을 작성하거나
- 백엔드에서 테스트 데이터 추가 필요

---

## 📞 문의

- **GitHub**: https://github.com/kimkichan1225/3DCommunity
- **브랜치**: `backend-new` (개발 중)
- **메인 브랜치**: `main`

---

**마지막 업데이트**: 2025-11-26
