# 프로젝트 분리 가이드: 3D Community & Messenger

이 문서는 현재 하나의 저장소 내에서 관리되고 있는 3D 앱(`3Dcommu`)과 메신저 앱(`Messenger_v2`)을 완전히 독립된 프로젝트로 분리하기 위한 기술적 전략과 단계를 설명합니다.

---

## 1. 프로젝트 구조 및 저장소 분리

가장 먼저 물리적인 소스 코드 저장소(Git Repository)를 분리해야 합니다.

### 권장 단계:
1.  **신규 저장소 생성**: `Messenger_v2` 폴더의 내용을 새로운 Git 저장소로 이동합니다.
2.  **의존성 정리**: 각 프로젝트의 `package.json`에서 서로를 참조하거나 공통으로 사용하는 로컬 경로가 있다면 이를 표준 npm 패키지나 공통 라이브러리 형태로 추출해야 합니다.
3.  **환경 변수 분리**: 각 프로젝트는 각자만의 `.env` 파일을 가지며, 백엔드 API 주소 등을 독립적으로 설정합니다.

---

## 2. 백엔드(API) 통합 및 공유 전략

현재 백엔드 서버는 `backend` 폴더 하나에 모든 기능(인증, 채팅, 친구, 게임 등)이 통합된 **모놀리스(Monolith)** 구조입니다.

### 전략:
*   **통합 백엔드 유지 (권장)**: 두 앱이 사용자 데이터와 채팅 이력을 실시간으로 공유해야 하므로, 백엔드는 분리하지 않고 **하나의 공통 API 서버**로 유지하는 것이 좋습니다. 백엔드까지 분리할 경우 데이터 동기화와 인프라 관리 복잡도가 비약적으로 상승합니다.
*   **API Gateway 도입 (장기적)**: 향후 서비스 규모가 매우 커지면 기능별로 서버를 쪼갤 수 있지만, 현재는 하나의 서버를 공유하되 엔드포인트를 명확히 구분하여 사용합니다.
*   **CORS 설정**: 백엔드에서 3D 앱(웹)과 메신저 앱(데스크톱/웹)의 Origin을 모두 허용하도록 설정해야 합니다.

---

## 3. 인증 및 보안 (Single Sign-On)

사용자가 3D 앱과 메신저 앱을 오갈 때 매번 로그인할 필요가 없도록 통합 인증 체계가 필요합니다.

### 구현 방법:
*   **JWT (JSON Web Token)**: 현재 사용 중인 JWT 기반 인증을 그대로 유지하되, 토큰 발급 및 검증 로직을 표준화합니다.
*   **인증 서버 분리 (옵션)**: `auth-server`를 별도로 두어 두 앱 모두 동일한 인증 서버를 바라보게 할 수 있습니다.

---

## 4. 공통 라이브러리 추출 (Shared Modules)

두 프로젝트에서 공통으로 사용하는 로직(API 호출 클라이언트, 웹소켓 처리 logic, 상수 등)은 중복 방지를 위해 별도의 패키지로 관리하는 것이 좋습니다.

### 추천 도구:
*   **npm Private Packages**: 조직 내에서만 공유되는 패키지로 배포.
*   **Monorepo (Nx, Turborepo)**: 프로젝트는 분리되어 있지만 하나의 큰 틀(Monorepo) 안에서 관리하여 코드 공유를 쉽게 할 수 있습니다.

---

## 5. 배포 및 인프라

*   **3D 앱**: 웹 기반이므로 Vercel, Netlify 또는 S3 + CloudFront를 통해 배포합니다.
*   **메신저 앱**: Electron 기반이므로 각 OS 빌드 프로세스를 독립적인 CI/CD 파이프라인(GitHub Actions 등)으로 구축합니다.

---

## 6. 요약 제언

1.  **단기**: 현재의 `Messenger_v2`를 별도 git repo로 옮기고, 백엔드 API 서버 주소를 환경 변수로 연결하는 것부터 시작하세요.
2.  **중기**: API 서비스 로직(`services/api.js` 등)을 별도 라이브러리화하여 두 프로젝트에서 동일한 코드를 사용하도록 하세요.
3.  **장기**: 사용자 알림(Push Notification) 서버를 고도화하여 3D 앱에 접속하지 않아도 메신저로 실시간 알림이 가도록 최적화하세요.

---
> [!IMPORTANT]
> 프로젝트 분리 후에는 **웹소켓 인증**과 **CORS** 설정이 가장 빈번한 오류의 원인이 됩니다. 분리 작업 시 이 부분을 최우선으로 점검하시기 바랍니다.
